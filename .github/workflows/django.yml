name: Django CI

on:
  push:
    branches: [ "master" ]
  pull_request:
    branches: [ "master" ]

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v1
    - name: Build & Push Image
      run: |
        echo "${{ secrets.DOCKERPW }}" | docker login -u "alienio" --password-stdin
        docker compose build
        docker push alienio/derzan-bot:latest
        curl -X POST \
        -H "Content-Type: application/json" \
        -H "Authorization: Bearer ${{ secrets.DO_TOKEN }}" \
        "https://api.digitalocean.com/v2/apps/${{ secrets.DO_APPID }}/deployments"
      
      
      
